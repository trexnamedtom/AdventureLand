//this code allows your merchant to give luck boosts to anyone within your range

setInterval(function(){
	
	for(id in parent.entities)	//searches everyone nearby
	{
		var current = parent.entities[id];

		if(current && current.type == 'character' && !current.npc)	//makes sure its a player
		{
			if(current.s.mluck)	//determines if they already have a mluck boost
			{
				if(current.s.mluck.f && current.s.mluck.f != character.name)	//checks to see if the boost is from you
				{
					if(can_attack(current))		//boosts them if they are in range
					{
						luck(current);
					}
				}
			}
			else
			{
				if(can_attack(current))		//if they dont already have a boost then boost them
				{
					luck(current);
				}
			}
		}
	}
	
}, 50);


var lastluck = new Date(0);
function luck(target){ 
	// Luck only if not on cd (cd is .1sec).
	if((new Date() - lastluck > 100)){
		parent.socket.emit("skill", {name: "mluck", id: target.id});
		set_message("Lucky " + target.name);
		lastluck = new Date();
	}
	
}
